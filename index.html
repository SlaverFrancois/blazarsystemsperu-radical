<!DOCTYPE html>
<html lang="zxx">

<head>
    <meta charset="UTF-8">
    <meta name="description" content="Directing Template">
    <meta name="keywords" content="Directing, unica, creative, html">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Directing | Template</title>

    <!-- Google Font -->
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;700;800&display=swap" rel="stylesheet">

    <!-- Css Styles -->
    <link rel="stylesheet" href="css/bootstrap.min.css" type="text/css">
    <link rel="stylesheet" href="css/font-awesome.min.css" type="text/css">
    <link rel="stylesheet" href="css/elegant-icons.css" type="text/css">
    <link rel="stylesheet" href="css/flaticon.css" type="text/css">
    <link rel="stylesheet" href="css/nice-select.css" type="text/css">
    <link rel="stylesheet" href="css/barfiller.css" type="text/css">
    <link rel="stylesheet" href="css/magnific-popup.css" type="text/css">
    <link rel="stylesheet" href="css/jquery-ui.min.css" type="text/css">
    <link rel="stylesheet" href="css/owl.carousel.min.css" type="text/css">
    <link rel="stylesheet" href="css/slicknav.min.css" type="text/css">
    <link rel="stylesheet" href="css/style.css" type="text/css">
</head>

<body>
    <!-- Page Preloder -->
    <div id="preloder">
        <div class="loader"></div>
    </div>
   <!-- Categories Section Begin -->
    <section class="categories spad" id="categories-section">
    <div class="container">
        <div class="row" id="categories-container">
        <div class="col-lg-12">
            <div class="section-title">
            <h2>Gran Red Local de Anunciantes</h2>
            <p>Compra, vende y ofrece servicios ‚Äî todo en un solo lugar</p>
            </div>

            <div class="tab-content">
            <div class="tab-pane active" id="tabs-1" role="tabpanel">
                <div class="row"><!-- Aqu√≠ se insertan los cards din√°micamente --></div>
            </div>
            </div>
        </div>
        </div>
    </div>
    </section>
    <!-- Categories Section End -->

    <!-- üîπ Listado general de profesionales -->
    <section class="news-post spad" id="all-professionals-section">
      <div class="container">
        <div class="section-title d-flex justify-content-between align-items-center">
          <h2>Top Profesionales del Mes</h2>
        </div>
        <div class="row" id="all-professionals-container"></div>
      </div>
    </section>


        <!-- Blog Section Begin -->
    <section class="news-post spad" id="results-section" style="display:none;">
    <div class="container">
        <div class="section-title d-flex justify-content-between align-items-center">
        <h2>Profesionales disponibles</h2>
        <button id="backBtn" class="btn btn-secondary">‚Üê Volver</button>
        </div>
        <div class="row" id="professionals-container"><!-- Aqu√≠ se insertan los resultados --></div>
    </div>
    </section>
    <!-- Blog Section End -->
      
    <!-- Footer Section Begin -->
    <footer class="footer">
        <div class="container">
            <div class="row">
                <div class="col-lg-3 col-md-6">
                    <div class="footer__about">
                        <div class="footer__about__logo">
                            <a href="./index.html"><img src="img/footer-logo.png" alt=""></a>
                        </div>
                        <p>Challenging the way things have always been done can lead to creative new options that reward
                            you.</p>
                    </div>
                </div>
                <div class="col-lg-4 offset-lg-1 col-md-6">
                    <div class="footer__address">
                        <ul>
                            <li>
                                <span>Call Us:</span>
                                <p>(+12) 345-678-910</p>
                            </li>
                            <li>
                                <span>Email:</span>
                                <p>info.colorlib@gmail .com</p>
                            </li>
                            <li>
                                <span>Connect Us:</span>
                                <div class="footer__social">
                                    <a href="#"><i class="fa fa-facebook"></i></a>
                                    <a href="#"><i class="fa fa-instagram"></i></a>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
 
            </div>
            <div class="row">
                <div class="col-lg-12">
                    <div class="footer__copyright">
                        <div class="footer__copyright__text"><p>
  Copyright &copy;<script>document.write(new Date().getFullYear());</script> 
  Todos los derechos reservados </p>
                        </div>
                        <div class="footer__copyright__links">
                            <a href="#">Terms</a>
                            <a href="#">Privacy Policy</a>
                            <a href="#">Cookie Policy</a>
                            <a href="./listing.html">Listing</a>
                            <a href="./about.html">About</a>
                            <a href="./listing-details.html">Listing Details</a>
                            <a href="./blog-details.html">Blog Details</a>
                            <a href="./blog.html">Blog</a>
                            <a href="./contact.html">Contact</a>
                            <a href="./index.html">Home</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <!-- Footer Section End -->

    <!-- Js Plugins -->
    <script src="js/jquery-3.3.1.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/jquery.nice-select.min.js"></script>
    <script src="js/jquery-ui.min.js"></script>
    <script src="js/jquery.nicescroll.min.js"></script>
    <script src="js/jquery.barfiller.js"></script>
    <script src="js/jquery.magnific-popup.min.js"></script>
    <script src="js/jquery.slicknav.js"></script>
    <script src="js/owl.carousel.min.js"></script>
    <script src="js/main.js"></script>

 <script>
document.addEventListener('DOMContentLoaded', () => {
  // -- primer fetch (si lo necesitas) para .categories__item__list (si existe)
  fetch('categories.json')
    .then(res => {
      if (!res.ok) throw new Error('No se pudo cargar el JSON');
      return res.json();
    })
    .then(categories => {
      const container = document.querySelector('.categories__item__list');
      if (container) {
        container.innerHTML = '';
        categories.forEach(cat => {
          const div = document.createElement('div');
          div.className = 'categories__item';
          div.innerHTML = `
            <img src="${cat.img}" alt="${cat.title}">
            <h5>${cat.title}</h5>
            <span>${cat.count}</span>
          `;
          container.appendChild(div);
        });
      }
    })
    .catch(err => console.error('Error cargando categor√≠as:', err));


  // -- Variables DOM usadas en el resto del script
  const categoriesContainer = document.querySelector('#categories-container');
  const resultsSection = document.querySelector('#results-section');
  const categoriesSection = document.querySelector('#categories-section');
  const professionalsContainer = document.querySelector('#professionals-container');
  const backBtn = document.querySelector('#backBtn');

  // üîπ Cargar categor√≠as (lista principal con columnas)
  fetch('categories.json')
    .then(res => res.json())
    .then(categories => {
      if (!categoriesContainer) return;
      categories.forEach(cat => {
        const col = document.createElement('div');
        col.className = 'col-lg-4 col-md-6';
        col.innerHTML = `
          <div class="listing__item category-card" data-category="${cat.title.toLowerCase()}">
            <div class="listing__item__text">
              <div class="listing__item__text__info">
                <div class="listing__item__text__info__left">
                  <img src="${cat.img}" alt="${cat.title}">
                  <span>${cat.title}</span>
                </div>
                <div class="listing__item__text__info__right">></div>
              </div>
            </div>
          </div>
        `;
        categoriesContainer.appendChild(col);
      });

      // üîπ Escuchar clic en cada card
      document.querySelectorAll('.category-card').forEach(card => {
        card.addEventListener('click', () => {
          const selectedCategory = card.dataset.category;
          showProfessionals(selectedCategory);
        });
      });
    })
    .catch(err => console.error('Error cargando categor√≠as (container):', err));


  // ---------------------------
  // showProfessionals: carga filtrada por categor√≠a con paginaci√≥n
  // ---------------------------
  function showProfessionals(category) {
    const allProfessionalsSection = document.querySelector('#all-professionals-section'); // para ocultar el Top

    fetch('professionals.json')
      .then(res => res.json())
      .then(data => {
        const filtered = data.filter(p => p.category.toLowerCase() === category);
        const perPage = 5;
        let currentPage = 1;

        const renderPage = () => {
          professionalsContainer.innerHTML = `
            <div class="col-lg-4 col-md-6">
              <div class="blog__item advertise-card">
                <div class="blog__item__text text-center">
                  <h5>¬øEres ${category}? üì¢</h5>
                  <p>An√∫nciate aqu√≠ y llega a cientos de clientes locales.</p>
                  <a href="https://forms.gle/TU_FORMULARIO_DE_GOOGLE" 
                     target="_blank" 
                     class="btn-advertise">Publica tu servicio</a>
                </div>
              </div>
            </div>
          `;

          if (filtered.length === 0) {
            professionalsContainer.innerHTML += `<p>No hay profesionales en esta categor√≠a.</p>`;
            return;
          }

          const totalPages = Math.ceil(filtered.length / perPage);
          const start = (currentPage - 1) * perPage;
          const end = start + perPage;
          const visibleItems = filtered.slice(start, end);

          // Mostrar profesionales
          visibleItems.forEach(p => {
            const div = document.createElement('div');
            div.className = 'col-lg-4 col-md-6';
            div.innerHTML = `
              <div class="blog__item">
                <div class="blog__item__text">
                  <ul class="blog__item__tags">
                    <li><i class="fa fa-tags"></i> ${p.category}</li>
                  </ul>
                  <h5>${p.description}</h5>
                  <ul class="blog__item__widget">
                    <li><i class="fa icon_phone"></i> ${p.phone}</li>
                    <li><i class="fa icon_pin_alt"></i> ${p.location}</li>
                    <li><i class="fa fa-user"></i> ${p.name}</li>
                    <li>
                      <a href="https://www.youtube.com/embed/${p.portfolio}?autoplay=1"
                         class="video-popup listing__item__pic__tag"
                         target="_blank" rel="noopener noreferrer">
                        Ver trabajos realizados
                      </a>
                    </li>
                  </ul>
                </div>
              </div>
            `;
            professionalsContainer.appendChild(div);
          });

          // üîπ Paginaci√≥n din√°mica (5 botones m√°x)
          const pagination = document.createElement('div');
          pagination.className = 'blog__pagination text-center mt-4';
          
          let startPage = Math.max(1, currentPage - 2);
          let endPage = Math.min(totalPages, startPage + 4);
          if (endPage - startPage < 4 && startPage > 1) startPage = Math.max(1, endPage - 4);

          let pageLinks = '';
          for (let i = startPage; i <= endPage; i++) {
            pageLinks += `<a href="#" class="page-link ${i === currentPage ? 'active' : ''}" data-page="${i}">${i}</a>`;
          }

          let html = '';
          if (currentPage > 1) {
            html += `<a href="#" class="prev">Anterior</a>`;
          }
          html += pageLinks;
          if (currentPage < totalPages) {
            html += `<a href="#" class="next">Siguiente</a>`;
          }
          pagination.innerHTML = html;

          professionalsContainer.appendChild(pagination);

          // üîπ Eventos de paginaci√≥n
          pagination.querySelectorAll('.page-link, .prev, .next').forEach(btn => {
            btn.addEventListener('click', e => {
              e.preventDefault();
              if (btn.classList.contains('disabled')) return;

              if (btn.classList.contains('prev') && currentPage > 1) currentPage--;
              else if (btn.classList.contains('next') && currentPage < totalPages) currentPage++;
              else if (btn.dataset.page) currentPage = parseInt(btn.dataset.page);

              renderPage();
            });
          });
        };

        renderPage();

        // Mostrar resultados y ocultar Top
        if (categoriesSection && resultsSection) {
          categoriesSection.style.display = 'none';
          resultsSection.style.display = 'block';
          if (allProfessionalsSection) allProfessionalsSection.style.display = 'none';
          backBtn.style.display = 'block';
          window.scrollTo({ top: 0, behavior: 'smooth' });
        }
      })
      .catch(err => console.error('Error cargando profesionales:', err));
  } // <-- fin showProfessionals


  // üîπ Mostrar/ocultar el bot√≥n volver
  if (backBtn) {
    backBtn.style.display = 'none';
    backBtn.addEventListener('click', () => {
      resultsSection.style.display = 'none';
      categoriesSection.style.display = 'block';
      const top = document.querySelector('#all-professionals-section');
      if (top) top.style.display = 'block';
      backBtn.style.display = 'none';
    });
  }

  // Cargar listado general (Top) al iniciar
  if (typeof loadAllProfessionals === 'function') loadAllProfessionals();
});
// <-- fin DOMContentLoaded


// ---------------------------
// loadAllProfessionals (definida fuera del DOMContentLoaded)
// ---------------------------
function loadAllProfessionals() {
  const allContainer = document.querySelector('#all-professionals-container');
  if (!allContainer) return;

  fetch('professionals.json')
    .then(res => res.json())
    .then(data => {
      // Ordenar destacados primero
      const ordered = data.slice().sort((a, b) => (b.featured === true) - (a.featured === true));

      const perPage = 6;
      let currentPage = 1;

      const renderPage = () => {
        allContainer.innerHTML = '';
        const totalPages = Math.ceil(ordered.length / perPage);
        const start = (currentPage - 1) * perPage;
        const end = start + perPage;
        const visible = ordered.slice(start, end);

        visible.forEach(p => {
          const div = document.createElement('div');
          div.className = 'col-lg-4 col-md-6';
          div.innerHTML = `
            <div class="blog__item">
              <div class="blog__item__text">
                <ul class="blog__item__tags">
                  <li><i class="fa fa-tags"></i> ${p.category}</li>
                </ul>
                <h5>${p.description}</h5>
                <ul class="blog__item__widget">
                  <li><i class="fa icon_phone"></i> ${p.phone}</li>
                  <li><i class="fa icon_pin_alt"></i> ${p.location}</li>
                  <li><i class="fa fa-user"></i> ${p.name}</li>
                  <li>
                    <a href="https://www.youtube.com/embed/${p.portfolio}?autoplay=1"
                       class="video-popup listing__item__pic__tag"
                       target="_blank" rel="noopener noreferrer">
                      Ver trabajos realizados
                    </a>
                  </li>
                </ul>
              </div>
            </div>
          `;
          allContainer.appendChild(div);
        });

        // Paginaci√≥n
        const pagination = document.createElement('div');
        pagination.className = 'blog__pagination text-center mt-4';
        const totalPages = Math.ceil(ordered.length / perPage);

        // construye s√≥lo las p√°ginas visibles
        let startPage = Math.max(1, currentPage - 2);
        let endPage = Math.min(totalPages, startPage + 4);
        if (endPage - startPage < 4 && startPage > 1) startPage = Math.max(1, endPage - 4);

        const totalPagesHTML = Array.from({ length: (endPage - startPage + 1) }, (_, idx) => {
          const i = startPage + idx;
          return `<a href="#" class="page-link ${i === currentPage ? 'active' : ''}" data-page="${i}">${i}</a>`;
        }).join('');

        let html = '';
        if (currentPage > 1) {
          html += `
            <a href="#" class="prev">
              <i class="fa fa-long-arrow-left"></i> Anterior
            </a>`;
        }
        html += totalPagesHTML;
        if (currentPage < totalPages) {
          html += `
            <a href="#" class="next">
              Siguiente <i class="fa fa-long-arrow-right"></i>
            </a>`;
        }
        pagination.innerHTML = html;

        allContainer.appendChild(pagination);

        // Eventos
        pagination.querySelectorAll('.page-link, .prev, .next').forEach(btn => {
          btn.addEventListener('click', e => {
            e.preventDefault();
            if (btn.classList.contains('prev') && currentPage > 1) currentPage--;
            else if (btn.classList.contains('next') && currentPage < totalPages) currentPage++;
            else if (btn.dataset.page) currentPage = parseInt(btn.dataset.page);
            renderPage();
          });
        });
      };

      renderPage();
    })
    .catch(err => console.error('Error cargando profesionales (all):', err));
}
</script>


</body>
</html>